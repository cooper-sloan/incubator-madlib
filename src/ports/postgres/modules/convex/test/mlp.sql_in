-- The data were collected by Anderson, Edgar (1935).
-- The irises of the Gaspe Peninsula, Bulletin of the American Iris Society, 59, 2â€“5.

DROP TABLE IF EXISTS iris_data, iris_test CASCADE;
CREATE TABLE iris_data(
    id integer,
    attributes numeric[],
    class_text varchar,
    class integer
);

INSERT INTO iris_data VALUES
(1,ARRAY[5.1,3.5,1.4,0.2],'Iris-setosa',0),
(2,ARRAY[4.9,3.0,1.4,0.2],'Iris-setosa',0),
(3,ARRAY[4.7,3.2,1.3,0.2],'Iris-setosa',0),
(4,ARRAY[4.6,3.1,1.5,0.2],'Iris-setosa',0),
(5,ARRAY[5.0,3.6,1.4,0.2],'Iris-setosa',0),
(6,ARRAY[5.4,3.9,1.7,0.4],'Iris-setosa',0),
(7,ARRAY[4.6,3.4,1.4,0.3],'Iris-setosa',0),
(8,ARRAY[5.0,3.4,1.5,0.2],'Iris-setosa',0),
(9,ARRAY[4.4,2.9,1.4,0.2],'Iris-setosa',0),
(10,ARRAY[4.9,3.1,1.5,0.1],'Iris-setosa',0),
(11,ARRAY[5.4,3.7,1.5,0.2],'Iris-setosa',0),
(12,ARRAY[4.8,3.4,1.6,0.2],'Iris-setosa',0),
(13,ARRAY[4.8,3.0,1.4,0.1],'Iris-setosa',0),
(14,ARRAY[4.3,3.0,1.1,0.1],'Iris-setosa',0),
(15,ARRAY[5.8,4.0,1.2,0.2],'Iris-setosa',0),
(16,ARRAY[5.7,4.4,1.5,0.4],'Iris-setosa',0),
(17,ARRAY[5.4,3.9,1.3,0.4],'Iris-setosa',0),
(18,ARRAY[5.1,3.5,1.4,0.3],'Iris-setosa',0),
(19,ARRAY[5.7,3.8,1.7,0.3],'Iris-setosa',0),
(20,ARRAY[5.1,3.8,1.5,0.3],'Iris-setosa',0),
(21,ARRAY[5.4,3.4,1.7,0.2],'Iris-setosa',0),
(22,ARRAY[5.1,3.7,1.5,0.4],'Iris-setosa',0),
(23,ARRAY[4.6,3.6,1.0,0.2],'Iris-setosa',0),
(24,ARRAY[5.1,3.3,1.7,0.5],'Iris-setosa',0),
(25,ARRAY[4.8,3.4,1.9,0.2],'Iris-setosa',0),
(26,ARRAY[5.0,3.0,1.6,0.2],'Iris-setosa',0),
(27,ARRAY[5.0,3.4,1.6,0.4],'Iris-setosa',0),
(28,ARRAY[5.2,3.5,1.5,0.2],'Iris-setosa',0),
(29,ARRAY[5.2,3.4,1.4,0.2],'Iris-setosa',0),
(30,ARRAY[4.7,3.2,1.6,0.2],'Iris-setosa',0),
(31,ARRAY[4.8,3.1,1.6,0.2],'Iris-setosa',0),
(32,ARRAY[5.4,3.4,1.5,0.4],'Iris-setosa',0),
(33,ARRAY[5.2,4.1,1.5,0.1],'Iris-setosa',0),
(34,ARRAY[5.5,4.2,1.4,0.2],'Iris-setosa',0),
(35,ARRAY[4.9,3.1,1.5,0.1],'Iris-setosa',0),
(36,ARRAY[5.0,3.2,1.2,0.2],'Iris-setosa',0),
(37,ARRAY[5.5,3.5,1.3,0.2],'Iris-setosa',0),
(38,ARRAY[4.9,3.1,1.5,0.1],'Iris-setosa',0),
(39,ARRAY[4.4,3.0,1.3,0.2],'Iris-setosa',0),
(40,ARRAY[5.1,3.4,1.5,0.2],'Iris-setosa',0),
(41,ARRAY[5.0,3.5,1.3,0.3],'Iris-setosa',0),
(42,ARRAY[4.5,2.3,1.3,0.3],'Iris-setosa',0),
(43,ARRAY[4.4,3.2,1.3,0.2],'Iris-setosa',0),
(44,ARRAY[5.0,3.5,1.6,0.6],'Iris-setosa',0),
(45,ARRAY[5.1,3.8,1.9,0.4],'Iris-setosa',0),
(46,ARRAY[4.8,3.0,1.4,0.3],'Iris-setosa',0),
(47,ARRAY[5.1,3.8,1.6,0.2],'Iris-setosa',0),
(48,ARRAY[4.6,3.2,1.4,0.2],'Iris-setosa',0),
(49,ARRAY[5.3,3.7,1.5,0.2],'Iris-setosa',0),
(50,ARRAY[5.0,3.3,1.4,0.2],'Iris-setosa',0),
(51,ARRAY[7.0,3.2,4.7,1.4],'Iris-versicolor',1),
(52,ARRAY[6.4,3.2,4.5,1.5],'Iris-versicolor',1),
(53,ARRAY[6.9,3.1,4.9,1.5],'Iris-versicolor',1),
(54,ARRAY[5.5,2.3,4.0,1.3],'Iris-versicolor',1),
(55,ARRAY[6.5,2.8,4.6,1.5],'Iris-versicolor',1),
(56,ARRAY[5.7,2.8,4.5,1.3],'Iris-versicolor',1),
(57,ARRAY[6.3,3.3,4.7,1.6],'Iris-versicolor',1),
(58,ARRAY[4.9,2.4,3.3,1.0],'Iris-versicolor',1),
(59,ARRAY[6.6,2.9,4.6,1.3],'Iris-versicolor',1),
(60,ARRAY[5.2,2.7,3.9,1.4],'Iris-versicolor',1),
(61,ARRAY[5.0,2.0,3.5,1.0],'Iris-versicolor',1),
(62,ARRAY[5.9,3.0,4.2,1.5],'Iris-versicolor',1),
(63,ARRAY[6.0,2.2,4.0,1.0],'Iris-versicolor',1),
(64,ARRAY[6.1,2.9,4.7,1.4],'Iris-versicolor',1),
(65,ARRAY[5.6,2.9,3.6,1.3],'Iris-versicolor',1),
(66,ARRAY[6.7,3.1,4.4,1.4],'Iris-versicolor',1),
(67,ARRAY[5.6,3.0,4.5,1.5],'Iris-versicolor',1),
(68,ARRAY[5.8,2.7,4.1,1.0],'Iris-versicolor',1),
(69,ARRAY[6.2,2.2,4.5,1.5],'Iris-versicolor',1),
(70,ARRAY[5.6,2.5,3.9,1.1],'Iris-versicolor',1),
(71,ARRAY[5.9,3.2,4.8,1.8],'Iris-versicolor',1),
(72,ARRAY[6.1,2.8,4.0,1.3],'Iris-versicolor',1),
(73,ARRAY[6.3,2.5,4.9,1.5],'Iris-versicolor',1),
(74,ARRAY[6.1,2.8,4.7,1.2],'Iris-versicolor',1),
(75,ARRAY[6.4,2.9,4.3,1.3],'Iris-versicolor',1),
(76,ARRAY[6.6,3.0,4.4,1.4],'Iris-versicolor',1),
(77,ARRAY[6.8,2.8,4.8,1.4],'Iris-versicolor',1),
(78,ARRAY[6.7,3.0,5.0,1.7],'Iris-versicolor',1),
(79,ARRAY[6.0,2.9,4.5,1.5],'Iris-versicolor',1),
(80,ARRAY[5.7,2.6,3.5,1.0],'Iris-versicolor',1),
(81,ARRAY[5.5,2.4,3.8,1.1],'Iris-versicolor',1),
(82,ARRAY[5.5,2.4,3.7,1.0],'Iris-versicolor',1),
(83,ARRAY[5.8,2.7,3.9,1.2],'Iris-versicolor',1),
(84,ARRAY[6.0,2.7,5.1,1.6],'Iris-versicolor',1),
(85,ARRAY[5.4,3.0,4.5,1.5],'Iris-versicolor',1),
(86,ARRAY[6.0,3.4,4.5,1.6],'Iris-versicolor',1),
(87,ARRAY[6.7,3.1,4.7,1.5],'Iris-versicolor',1),
(88,ARRAY[6.3,2.3,4.4,1.3],'Iris-versicolor',1),
(89,ARRAY[5.6,3.0,4.1,1.3],'Iris-versicolor',1),
(90,ARRAY[5.5,2.5,4.0,1.3],'Iris-versicolor',1),
(91,ARRAY[5.5,2.6,4.4,1.2],'Iris-versicolor',1),
(92,ARRAY[6.1,3.0,4.6,1.4],'Iris-versicolor',1),
(93,ARRAY[5.8,2.6,4.0,1.2],'Iris-versicolor',1),
(94,ARRAY[5.0,2.3,3.3,1.0],'Iris-versicolor',1),
(95,ARRAY[5.6,2.7,4.2,1.3],'Iris-versicolor',1),
(96,ARRAY[5.7,3.0,4.2,1.2],'Iris-versicolor',1),
(97,ARRAY[5.7,2.9,4.2,1.3],'Iris-versicolor',1),
(98,ARRAY[6.2,2.9,4.3,1.3],'Iris-versicolor',1),
(99,ARRAY[5.1,2.5,3.0,1.1],'Iris-versicolor',1),
(100,ARRAY[5.7,2.8,4.1,1.3],'Iris-versicolor',1);


SELECT mlp(
    'iris_data',      -- Source table
    'temp_result',    -- Desination table
    'ARRAY[class]',   -- Label
    'attributes',     -- Input features
    ARRAY[4,5,1],     -- Number of units per layer
    'step_size=0.5,
    n_iterations=100,
    tolerance=0');


SELECT assert(
    loss < 0.1,
    'MLP: Loss is too high (> 0.1). Wrong result.'
) FROM temp_result;

